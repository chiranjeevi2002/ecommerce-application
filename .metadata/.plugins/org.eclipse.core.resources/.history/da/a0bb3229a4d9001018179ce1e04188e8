package com.ecommerce.paymentservice.controller;

import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import com.ecommerce.paymentservice.dto.PaymentRequest;
import com.ecommerce.paymentservice.dto.PaymentResponse;
import com.ecommerce.paymentservice.service.PaymentService;

import java.util.List;

@RestController
@RequestMapping("/paymentservice/payments")
public class PaymentController {

    private final PaymentService paymentService;

    public PaymentController(PaymentService service) {
        this.paymentService = service;
    }

    // CREATE PAYMENT - Used by OrderService
    @PostMapping
    public ResponseEntity<PaymentResponse> createPayment(
    		@RequestHeader("X-Store-Id") Long storeId,
    		@RequestBody PaymentRequest request) {
        PaymentResponse response = paymentService.createPayment(request,storeId);
        return ResponseEntity.status(201).body(response);
    }

    // GET PAYMENT BY ID
    @GetMapping("/{id}")
    public ResponseEntity<PaymentResponse> getPaymentById( @RequestHeader("X-Store-Id") Long storeId, @PathVariable Long id) {
        PaymentResponse response = paymentService.getPaymentById(id,storeId);
        return ResponseEntity.ok(response);
    }

    // GET ALL PAYMENTS
    @GetMapping
    public ResponseEntity<List<PaymentResponse>> getAllPayments(@RequestHeader("X-Store-Id") Long storeId) {
        List<PaymentResponse> list = paymentService.getPaymentsByStore(storeId);
        return ResponseEntity.ok(list);
    }

    // UPDATE PAYMENT
    @PutMapping("/{id}")
    public ResponseEntity<PaymentResponse> updatePayment(
    		@RequestHeader("X-Store-Id") Long storeId,
            @PathVariable Long id,
            @RequestBody PaymentRequest request
    ) {
        PaymentResponse response = paymentService.updatePayment(id,storeId, request);
        return ResponseEntity.ok(response);
    }

    // DELETE PAYMENT
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> deletePayment(@RequestHeader("X-Store-Id") Long storeId,@PathVariable Long id) {
        paymentService.deletePayment(id,storeId);
        return ResponseEntity.noContent().build();
    }
}
