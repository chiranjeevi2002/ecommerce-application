package com.ecommerce.apigateway.config;

import org.springframework.cloud.gateway.route.RouteLocator;
import org.springframework.cloud.gateway.route.builder.RouteLocatorBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

import com.ecommerce.common.security.SecurityConstants;

@Configuration
public class GatewayRoutesConfig {

    @Bean
    public RouteLocator routes(RouteLocatorBuilder builder) {

        return builder.routes()

            // PRODUCT SERVICE (public + secured handled by service)
            .route("product-service", r -> r
                .path(SecurityConstants.PRODUCTS, SecurityConstants.ADMIN)
                .uri("lb://PRODUCTSERVICE")
            )

            // ORDER SERVICE (secured in OrderService)
            .route("order-service", r -> r
                .path(SecurityConstants.ORDERS)
                .uri("lb://ORDERSERVICE")
            )

            // INVENTORY SERVICE (secured in InventoryService)
            .route("inventory-service", r -> r
                .path(SecurityConstants.INVENTORY)
                .uri("lb://INVENTORYSERVICE")
            )

            // PAYMENT SERVICE (secured in PaymentService)
            .route("payment-service", r -> r
                .path(SecurityConstants.PAYMENTS)
                .uri("lb://PAYMENTSERVICE")
            )

            .build();
    }
}
