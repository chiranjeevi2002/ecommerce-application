package com.ecommerce.common.context;


import java.util.List;
import java.util.Optional;

public final class RequestContextMapper {

    private RequestContextMapper() {}

    public static RequestContext fromHeaders(
            String userId,
            String storeId,
            String username,
            String roles,
            String authorization
    ) {
        return new RequestContext(
                parseLong(userId),
                parseLong(storeId),
                username,
                parseRoles(roles),
                authorization
        );
    }

    private static Long parseLong(String value) {
        return Optional.ofNullable(value)
                .map(Long::valueOf)
                .orElse(null);
    }

    private static List<String> parseRoles(String roles) {
        if (roles == null || roles.isBlank()) {
            return List.of();
        }
        return List.of(roles.split(","));
    }
}
